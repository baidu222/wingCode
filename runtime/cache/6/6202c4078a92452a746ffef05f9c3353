{"content":{"file_id":"\n<!--用来存放文件信息-->\n<input id=\"pickfilesid\" type=\"hidden\" name=\"file_id\" value=\"0\"/>\n\n<link rel=\"stylesheet\" href=\"/static/admin/js/webuploader/webuploader.css\" type=\"text/css\">\n<div id=\"thelist_file_id\" class=\"uploader-list\"></div>\n<div class=\"btns\">\n    <div id=\"picker_file_id\" class=\"picker\">选择文件</div>\n    <a id=\"ctlBtn_file_id\" class=\"btn btn-default\">开始上传</a>\n</div>\n<script src=\"/static/admin/js/webuploader/webuploader.js\" type=\"text/javascript\"></script>\n<script type=\"text/javascript\">\n    jQuery(function() {\n        var $ = jQuery,\n            $list_file_id = $('#thelist_file_id'),\n            $btn_file_id = $('#ctlBtn_file_id'),\n            state = 'pending',\n            uploader_file_id;\n\n        uploader_file_id = WebUploader.create({\n\n            // 不压缩image\n            resize: false,\n\n            // swf文件路径\n            swf:'/static/admin/js/webuploader/Uploader.swf',\n\n            // 文件接收服务端。\n            server: '/ext/attachment/homefile/upload',\n\n            // 选择文件的按钮。可选。\n            // 内部根据当前运行是创建，可能是input元素，也可能是flash.\n            pick: {\n                id:'#picker_file_id',\n                multiple: false\n            },\n            fileNumLimit:1,\n\n        });\n\n        // 当有文件添加进来的时候\n        uploader_file_id.on( 'fileQueued', function( file ) {\n\n            $list_file_id.html( '<div id=\"' + file.id + '\" class=\"alert alert-info\">' +\n                ' <button data-dismiss=\"alert\" class=\"close remove-this\" type=\"button\">×</button>'+\n                '<h4 class=\"info\">' + file.name + '</h4>' +\n                '<p class=\"state\">等待上传...</p>' +\n                '</div>' );\n            var $li_file_id = $( '#'+file.id );\n            $li_file_id.on('click', '.remove-this', function() {\n                uploader_file_id.removeFile( file.id );\n//                                                                                 $list_file_id.html(\"\");\n            })\n\n        });\n\n        // 文件上传过程中创建进度条实时显示。\n        uploader_file_id.on( 'uploadProgress', function( file, percentage ) {\n            var $li_file_id = $( '#'+file.id ),\n                $percent_file_id = $li_file_id.find('.progress .progress-bar');\n\n            // 避免重复创建\n            if ( !$percent_file_id.length ) {\n                $percent_file_id = $('<div class=\"progress progress-striped active\">' +\n                    '<div class=\"progress-bar\" role=\"progressbar\" style=\"width: 0%\">' +\n                    '</div>' +\n                    '</div>').appendTo( $li_file_id ).find('.progress-bar');\n            }\n\n            $li_file_id.find('p.state').text('上传中');\n\n            $percent_file_id.css( 'width', percentage * 100 + '%' );\n        });\n\n        uploader_file_id.on( 'uploadSuccess', function( file,res ) {\n            var name = \"file_id\";\n            $(\"input[name=\"+name+\"]\").val(res.id);\n            $( '#'+file.id ).find('p.state').text('已上传,文件大小:'+res.size);\n        });\n\n        uploader_file_id.on( 'uploadError', function( file ) {\n            $( '#'+file.id ).find('p.state').text('上传出错');\n        });\n\n        uploader_file_id.on( 'uploadComplete', function( file ) {\n            $( '#'+file.id ).find('.progress').fadeOut();\n        });\n\n        uploader_file_id.on( 'all', function( type ) {\n            if ( type === 'startUpload' ) {\n                state = 'uploading';\n            } else if ( type === 'stopUpload' ) {\n                state = 'paused';\n            } else if ( type === 'uploadFinished' ) {\n                state = 'done';\n            }\n\n            if ( state === 'uploading' ) {\n                $btn_file_id.text('暂停上传');\n            } else {\n                $btn_file_id.text('开始上传');\n            }\n        });\n\n        $btn_file_id.on( 'click', function() {\n            if ( state === 'uploading' ) {\n                uploader_file_id.stop();\n            } else {\n                uploader_file_id.upload();\n            }\n        });\n    });\n\n</script>\n\n"},"expire":1603418238643}